function e(e){const t=$(`.mes[mesid="${e}"]`);if(0===t.length)return;const n=t.find('.tokenCounterDisplay');if(0===n.length)return;const s=n.text().match(/(\d+)t/);if(!s)return;const r=t.find('.mes_text').clone();r.find('details').remove();let i=r.text();i=i.replace(/<[^>]+>.*?<\/[^>]+>/gs,'');const o=i.length;let l=0;{let e=t.find('.mes_reasoning').text();e=e.replace(/<[^>]+>.*?<\/[^>]+>/gs,''),l=e.length}const c=s[1],m=l>0?`${c}t(${l}+${o})`:`${c}t(${o})`;n.text(m)}$(()=>{eventOn(tavern_events.MESSAGE_RECEIVED,t=>{setTimeout(()=>e(Number(t)),200)}),eventOn(tavern_events.MESSAGE_UPDATED,t=>{setTimeout(()=>e(Number(t)),200)}),eventOn(tavern_events.STREAM_REASONING_DONE,(_,t,n)=>{setTimeout(()=>e(n),200)})});
//# sourceMappingURL=index.js.map